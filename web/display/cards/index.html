<!DOCTYPE html>
<html lang="de">
    <head>
        <base href="/openWB/web/">
        <meta charset="UTF-8">
        <link rel="stylesheet" type="text/css" href="css/bootstrap.css">
        <link rel="stylesheet" type="text/css" href="css/bootstrap-4.4.1/bootstrap.min.css">
        <!-- Normalize -->
        <link rel="stylesheet" type="text/css" href="css/normalize-8.0.1.css">
        <!-- Font Awesome, all styles -->
        <link rel="stylesheet" type="text/css" href="fonts/font-awesome-5.8.2/css/all.css">
        <!-- important scripts to be loaded -->
        <script src="js/jquery-3.4.1.min.js"></script>
        <script src="display/cards/jquery.sparkline.js"></script>
        <script src="js/bootstrap-4.4.1/bootstrap.bundle.min.js"></script>
        <!-- display style -->
        <link rel="stylesheet" type="text/css" href="display/cards/style.css">
    </head>

    <body>
        <!-- Side navigation -->
        <div class="sidenav pt-3">
            <!-- date and lock status -->
            <div class="row">
                <div class="col px-0">
                    <h4 id="date" class="col text-center text-light">Do, 19.11.2020</h4>
                    <h4 id="time" class="col text-center text-light">12:36</h4>
                </div>
                <div class="col-3 px-0" id="displaylock">
                    <i class="fas fa-lock text-success h4"></i>
                    <i class="fas fa-unlock text-danger h4 hide"></i>
                </div>
            </div>
            <hr class="border-info mt-1">
            <!-- nav elements -->
            <a class="btn btn-outline-info btn-toggle active" href="#dashboard" onclick="return false;">Dashboard</a><br>
            <a class="btn btn-outline-info" href="#ladepunkte" onclick="return false;">Ladepunkte</a><br>
            <a class="btn btn-outline-info" href="#code" onclick="return false;">Code</a><br>
            <a class="btn btn-outline-danger text-danger hide" id="lastmanagementShowBtn" onclick="return false;">Warnungen</a><br>
        </div>

        <!-- Dashboard -->
        <div id="dashboard" class="dashboard resume">
            <div class="row">
                <!-- EVU data -->
                <div class=" col-xs-6 card evu">
                    <div class="card-header bg-danger">
                        <div class="row">
                            <div class="col pr-0">
                                EVU
                            </div>
                            <div id="evul" class="col-7 pl-0 text-right">
                                --
                            </div>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="form-row mb-1">
                            <span class="sparkline" id="evulchart" values="" data-chartName="evulchart" sparkBarColor="#dc3545" sparkNegBarColor="green">Lade Daten</span>
                        </div>
                    </div>
                </div>
                <!-- Hausverbrauch data -->
                <div class=" col-xs-6 card hausverbrauch">
                    <div class="card-header bg-secondary">
                        <div class="row">
                            <div class="col pr-0">
                                Hausverbrauch
                            </div>
                            <div id="hausverbrauchl" class="col-4 pl-0 text-right">
                                --
                            </div>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="form-row mb-1">
                            <span class="sparkline" id="hausverbrauchlchart" values="" data-chartName="hausverbrauchlchart" sparkBarColor="#6c757d" sparkChartRangeMin="0">Lade Daten</span>
                        </div>
                    </div>
                </div>
                <!-- Speicherleistung data -->
                <div class=" col-xs-6 card hausbatterie">
                    <div class="card-header bg-warning">
                        <div class="row">
                            <div class="col pr-0">
                                Speicher
                            </div>
                            <div id="hausbatteriell" class="col-8 pl-0 text-right">
                                --
                            </div>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="form-row mb-1">
                            <span class="sparkline" id="hausbatteriellchart" values="" data-chartName="hausbatteriellchart" sparkBarColor="#ffc107" sparkNegBarColor="orange">Lade Daten</span>
                        </div>
                    </div>
                </div>
                <!-- SpeicherSoC data -->
                <div class="col-xs-6 card hausbatterie">
                    <div class="card-header bg-warning">
                        <div class="row">
                            <div class="col pr-0">
                                Speicher SoC
                            </div>
                            <div id="hausbatteriesoc" class="col-5 pl-0 text-right">
                                --
                            </div>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="form-row mb-1">
                            <span class="sparkline" id="hausbatteriesocchart" values="" data-chartName="hausbatteriesocchart" sparkBarColor="#ffc107" sparkChartRangeMin="0" sparkChartRangeMax="100">Lade Daten</span>
                        </div>
                    </div>
                </div>
                <!-- Ladeleistung gesamt data -->
                <div class="col-xs-6 card gesamtll">
                    <div class="card-header bg-primary">
                        <div class="row">
                            <div class="col pr-0">
                                Ladeleistung Ges.
                            </div>
                            <div id="gesamtll" class="col-5 pl-0 text-right">
                                --
                            </div>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="form-row mb-1">
                            <span class="sparkline" id="gesamtllchart" values="" data-chartName="gesamtllchart" sparkBarColor="#007bff" sparkChartRangeMin="0">Lade Daten</span>
                        </div>
                    </div>
                </div>
                <!-- PV data -->
                <div class="col-xs-6 card pv">
                    <div class="card-header bg-success">
                        <div class="row">
                            <div class="col pr-0">
                                PV
                            </div>
                            <div id="pvl" class="col-7 pl-0 text-right">
                                --
                            </div>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="form-row mb-1">
                            <span class="sparkline" id="pvlchart" values="" data-chartName="pvlchart" sparkBarColor="#28a745" sparkChartRangeMin="0">Lade Daten</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Ladepunkte -->
        <div id="ladepunkte" class="ladepunkte resume">
            <!-- Ladepunkt 1 -->
            <div class="row" data-lp="1">
                <div class="card col-xs-12">
                    <div class="card-header bg-primary">
                        <div class="row pr-3">
                            <div class="col cursor-pointer nameLp enableLp lpDisabledStyle">
                                Ladepunkt 1
                            </div>
                            <div class="col-3 text-center bg-dark" style="border-radius: 5px;">
                                <span class="fas fa hide autolockConfiguredLp"></span>
                                <span class="fa fa fa-plug hide text-orange plugstatLp"></span>
                                <span class="fa fa fa-flag-checkered hide targetChargingLp"></span>
                                <span class="fa fa fa-moon hide nightChargingLp"></span>
                            </div>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="form-row">
                            <div class="col">
                                <!-- chargepoint actual values -->
                                <div class="form-row mb-1">
                                    <div class="col-8">
                                        <span class="actualPowerLp ladepunktll">Lade Daten</span>&nbsp;
                                        <span class="phasesInUseLp"></span>&nbsp;
                                        <span class="targetCurrentLp"></span>
                                    </div>
                                    <div class="col text-right socConfiguredLp">
                                        <i class="fas fa-car-battery"></i> <span class="socLp">--</span>
                                    </div>
                                </div>
                                <div class="form-row mb-1">
                                    <div class="col sparkline ladepunktllchart" data-chartName="ladepunkt1llchart" values="" sparkBarColor="#007bff" sparkChartRangeMin="0"></div>
                                </div>
                            </div>
                            <div class="col-sm-4 d-flex align-items-stretch">
                                <button class="btn btn-block btn-info chargeModeSelectBtn" type="button">
                                    <span class="chargeModeSelectBtnText">Modus</span>
                                    <span class="priorityEvBattery">
                                        <span class="fas fa-car priorityEvBatteryIcon">&nbsp;</span>
                                    </span>
                                </button>
                            </div>
                            <div class="col-sm-2 d-flex align-items-stretch">
                                <button class="btn btn-block btn-outline-info ladepunktConfigBtn" type="button">
                                    <i class="fas fa-wrench"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Ladepunkt 2 -->
            <div class="row" data-lp="2">
                <div class="card col-xs-12">
                    <div class="card-header bg-primary">
                        <div class="row pr-3">
                            <div class="col cursor-pointer nameLp enableLp lpDisabledStyle">
                                Ladepunkt 2
                            </div>
                            <!-- chargepoint info section -->
                            <div class="col-3 text-center bg-dark" style="border-radius: 5px;">
                                <span class="fas fa hide autolockConfiguredLp"></span>
                                <span class="fa fa fa-plug hide text-orange plugstatLp"></span>
                                <span class="fa fa fa-flag-checkered hide targetChargingLp"></span>
                                <span class="fa fa fa-moon hide nightChargingLp"></span>
                            </div>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="form-row">
                            <div class="col">
                                <!-- chargepoint actual values -->
                                <div class="form-row mb-1">
                                    <div class="col">
                                        <span class="actualPowerLp ladepunktll">Lade Daten</span>&nbsp;
                                        <span class="phasesInUseLp"></span>&nbsp;
                                        <span class="targetCurrentLp"></span>
                                    </div>
                                    <div class="col text-right socConfiguredLp">
                                        <i class="fas fa-car-battery"></i> <span class="socLp">--</span>
                                    </div>
                                </div>
                                <div class="form-row mb-1">
                                    <div class="col sparkline ladepunktllchart" values="" data-chartName="ladepunkt2llchart" sparkBarColor="#007bff" sparkChartRangeMin="0"></div>
                                </div>
                            </div>
                            <!-- charge mode button -->
                            <div class="col-sm-4 d-flex align-items-stretch">
                                <button class="btn btn-block btn-info chargeModeSelectBtn hide" type="button">
                                    <span class="chargeModeSelectBtnText">Lademodus</span>
                                    <span class="priorityEvBattery">
                                        <span class="fas fa-car priorityEvBatteryIcon">&nbsp;</span>
                                    </span>
                                </button>
                            </div>
                            <!-- chargepoint settings -->
                            <div class="col-sm-2 d-flex align-items-stretch">
                                <button class="btn btn-block btn-outline-info ladepunktConfigBtn" type="button">
                                    <i class="fas fa-wrench"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Ladepunkt 3 -->
            <div class="row" data-lp="3">
                <div class="card col-xs-12">
                    <div class="card-header bg-primary">
                        <div class="row pr-3">
                            <div class="col cursor-pointer nameLp enableLp lpDisabledStyle">
                                Ladepunkt 3
                            </div>
                            <div class="col-3 text-center bg-dark" style="border-radius: 5px;">
                                <span class="fas fa hide autolockConfiguredLp"></span>
                                <span class="fa fa fa-plug hide text-orange plugstatLp"></span>
                                <span class="fa fa fa-flag-checkered hide targetChargingLp"></span>
                                <span class="fa fa fa-moon hide nightChargingLp"></span>
                            </div>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="form-row">
                            <div class="col">
                                <div class="form-row mb-1">
                                    <span class="actualPowerLp ladepunktll">Lade Daten</span>&nbsp;
                                    <span class="phasesInUseLp"></span>&nbsp;
                                    <span class="targetCurrentLp"></span>
                                </div>
                                <div class="form-row mb-1">
                                    <span class="sparkline ladepunktllchart" values="" data-chartName="ladepunkt3llchart" sparkBarColor="#007bff" sparkChartRangeMin="0"></span>
                                </div>
                            </div>
                            <div class="col-sm-4 d-flex align-items-stretch">
                                <button class="btn btn-block btn-info chargeModeSelectBtn hide" type="button">
                                    <span class="chargeModeSelectBtnText">Lademodus</span>
                                    <span class="priorityEvBattery">
                                        <span class="fas fa-car priorityEvBatteryIcon">&nbsp;</span>
                                    </span>
                                </button>
                            </div>
                            <div class="col-sm-2 d-flex align-items-stretch">
                                <button class="btn btn-block btn-outline-info ladepunktConfigBtn" type="button">
                                    <i class="fas fa-wrench"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Ladepunkt 4 -->
            <div class="row" data-lp="4">
                <div class="card col-xs-12">
                    <div class="card-header bg-primary">
                        <div class="row pr-3">
                            <div class="col cursor-pointer nameLp enableLp lpDisabledStyle">
                                Ladepunkt 4
                            </div>
                            <div class="col-3 text-center bg-dark" style="border-radius: 5px;">
                                <span class="fas fa hide autolockConfiguredLp"></span>
                                <span class="fa fa fa-plug hide text-orange plugstatLp"></span>
                                <span class="fa fa fa-flag-checkered hide targetChargingLp"></span>
                                <span class="fa fa fa-moon hide nightChargingLp"></span>
                            </div>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="form-row">
                            <div class="col">
                                <div class="form-row mb-1">
                                    <span class="actualPowerLp ladepunktll">Lade Daten</span>&nbsp;
                                    <span class="phasesInUseLp"></span>&nbsp;
                                    <span class="targetCurrentLp"></span>
                                </div>
                                <div class="form-row mb-1">
                                    <span class="sparkline ladepunktllchart" values="" data-chartName="ladepunkt4llchart" sparkBarColor="#007bff" sparkChartRangeMin="0"></span>
                                </div>
                            </div>
                            <div class="col-sm-4 d-flex align-items-stretch">
                                <button class="btn btn-block btn-info chargeModeSelectBtn hide" type="button">
                                    <span class="chargeModeSelectBtnText">Lademodus</span>
                                    <span class="priorityEvBattery">
                                        <span class="fas fa-car priorityEvBatteryIcon">&nbsp;</span>
                                    </span>
                                </button>
                            </div>
                            <div class="col-sm-2 d-flex align-items-stretch">
                                <button class="btn btn-block btn-outline-info ladepunktConfigBtn" type="button">
                                    <i class="fas fa-wrench"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Ladepunkt 5 -->
            <div class="row" data-lp="5">
                <div class="card col-xs-12">
                    <div class="card-header bg-primary">
                        <div class="row pr-3">
                            <div class="col cursor-pointer nameLp enableLp lpDisabledStyle">
                                Ladepunkt 5
                            </div>
                            <div class="col-3 text-center bg-dark" style="border-radius: 5px;">
                                <span class="fas fa hide autolockConfiguredLp"></span>
                                <span class="fa fa fa-plug hide text-orange plugstatLp"></span>
                                <span class="fa fa fa-flag-checkered hide targetChargingLp"></span>
                                <span class="fa fa fa-moon hide nightChargingLp"></span>
                            </div>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="form-row">
                            <div class="col">
                                <div class="form-row mb-1">
                                    <span class="actualPowerLp ladepunktll">Lade Daten</span>&nbsp;
                                    <span class="phasesInUseLp"></span>&nbsp;
                                    <span class="targetCurrentLp"></span>
                                </div>
                                <div class="form-row mb-1">
                                    <span class="sparkline ladepunktllchart" values="" data-chartName="ladepunkt5llchart" sparkBarColor="#007bff" sparkChartRangeMin="0"></span>
                                </div>
                            </div>
                            <div class="col-sm-4 d-flex align-items-stretch">
                                <button class="btn btn-block btn-info chargeModeSelectBtn hide" type="button">
                                    <span class="chargeModeSelectBtnText">Lademodus</span>
                                    <span class="priorityEvBattery">
                                        <span class="fas fa-car priorityEvBatteryIcon">&nbsp;</span>
                                    </span>
                                </button>
                            </div>
                            <div class="col-sm-2 d-flex align-items-stretch">
                                <button class="btn btn-block btn-outline-info ladepunktConfigBtn" type="button">
                                    <i class="fas fa-wrench"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Ladepunkt 6 -->
            <div class="row" data-lp="6">
                <div class="card col-xs-12">
                    <div class="card-header bg-primary">
                        <div class="row pr-3">
                            <div class="col cursor-pointer nameLp enableLp lpDisabledStyle">
                                Ladepunkt 2
                            </div>
                            <div class="col-3 text-center bg-dark" style="border-radius: 5px;">
                                <span class="fas fa hide autolockConfiguredLp"></span>
                                <span class="fa fa fa-plug hide text-orange plugstatLp"></span>
                                <span class="fa fa fa-flag-checkered hide targetChargingLp"></span>
                                <span class="fa fa fa-moon hide nightChargingLp"></span>
                            </div>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="form-row">
                            <div class="col">
                                <div class="form-row mb-1">
                                    <span class="actualPowerLp ladepunktll">Lade Daten</span>&nbsp;
                                    <span class="phasesInUseLp"></span>&nbsp;
                                    <span class="targetCurrentLp"></span>
                                </div>
                                <div class="form-row mb-1">
                                    <span class="sparkline ladepunktllchart" values="" data-chartName="ladepunkt6llchart" sparkBarColor="#007bff" sparkChartRangeMin="0"></span>
                                </div>
                            </div>
                            <div class="col-sm-4 d-flex align-items-stretch">
                                <button class="btn btn-block btn-info chargeModeSelectBtn hide" type="button">
                                    <span class="chargeModeSelectBtnText">Lademodus</span>
                                    <span class="priorityEvBattery">
                                        <span class="fas fa-car priorityEvBatteryIcon">&nbsp;</span>
                                    </span>
                                </button>
                            </div>
                            <div class="col-sm-2 d-flex align-items-stretch">
                                <button class="btn btn-block btn-outline-info ladepunktConfigBtn" type="button">
                                    <i class="fas fa-wrench"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Ladepunkt 7 -->
            <div class="row" data-lp="7">
                <div class="card col-xs-12">
                    <div class="card-header bg-primary">
                        <div class="row pr-3">
                            <div class="col cursor-pointer nameLp enableLp lpDisabledStyle">
                                Ladepunkt 7
                            </div>
                            <div class="col-3 text-center bg-dark" style="border-radius: 5px;">
                                <span class="fas fa hide autolockConfiguredLp"></span>
                                <span class="fa fa fa-plug hide text-orange plugstatLp"></span>
                                <span class="fa fa fa-flag-checkered hide targetChargingLp"></span>
                                <span class="fa fa fa-moon hide nightChargingLp"></span>
                            </div>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="form-row">
                            <div class="col">
                                <div class="form-row mb-1">
                                    <span class="actualPowerLp ladepunktll">Lade Daten</span>&nbsp;
                                    <span class="phasesInUseLp"></span>&nbsp;
                                    <span class="targetCurrentLp"></span>
                                </div>
                                <div class="form-row mb-1">
                                    <span class="sparkline ladepunktllchart" values="" data-chartName="ladepunkt7llchart" sparkBarColor="#007bff" sparkChartRangeMin="0"></span>
                                </div>
                            </div>
                            <div class="col-sm-4 d-flex align-items-stretch">
                                <button class="btn btn-block btn-info chargeModeSelectBtn hide" type="button">
                                    <span class="chargeModeSelectBtnText">Lademodus</span>
                                    <span class="priorityEvBattery">
                                        <span class="fas fa-car priorityEvBatteryIcon">&nbsp;</span>
                                    </span>
                                </button>
                            </div>
                            <div class="col-sm-2 d-flex align-items-stretch">
                                <button class="btn btn-block btn-outline-info ladepunktConfigBtn" type="button">
                                    <i class="fas fa-wrench"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Ladepunkt 8 -->
            <div class="row" data-lp="8">
                <div class="card col-xs-12">
                    <div class="card-header bg-primary">
                        <div class="row pr-3">
                            <div class="col cursor-pointer nameLp enableLp lpDisabledStyle">
                                Ladepunkt 8
                            </div>
                            <div class="col-3 text-center bg-dark" style="border-radius: 5px;">
                                <span class="fas fa hide autolockConfiguredLp"></span>
                                <span class="fa fa fa-plug hide text-orange plugstatLp"></span>
                                <span class="fa fa fa-flag-checkered hide targetChargingLp"></span>
                                <span class="fa fa fa-moon hide nightChargingLp"></span>
                            </div>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="form-row">
                            <div class="col">
                                <div class="form-row mb-1">
                                    <span class="actualPowerLp ladepunktll">Lade Daten</span>&nbsp;
                                    <span class="phasesInUseLp"></span>&nbsp;
                                    <span class="targetCurrentLp"></span>
                                </div>
                                <div class="form-row mb-1">
                                    <span class="sparkline ladepunktllchart" values="" data-chartName="ladepunkt8llchart" sparkBarColor="#007bff" sparkChartRangeMin="0"></span>
                                </div>
                            </div>
                            <div class="col-sm-4 d-flex align-items-stretch">
                                <button class="btn btn-block btn-info chargeModeSelectBtn hide" type="button">
                                    <span class="chargeModeSelectBtnText">Lademodus</span>
                                    <span class="priorityEvBattery">
                                        <span class="fas fa-car priorityEvBatteryIcon">&nbsp;</span>
                                    </span>
                                </button>
                            </div>
                            <div class="col-sm-2 d-flex align-items-stretch">
                                <button class="btn btn-block btn-outline-info ladepunktConfigBtn" type="button">
                                    <i class="fas fa-wrench"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <script>
                var currentConfigureLp = 1;
                $('.ladepunktConfigBtn').click(function(event){
                    if( displaylocked == false ){
                        currentConfigureLp = parseInt($(this).closest('[data-lp]').data('lp'));  // get attribute lp-# of parent element
                        $('#ladepunktConfigModal').find('.configLp').text(currentConfigureLp);
                        $('#ladepunktConfigModal').find('[data-config-lp]').addClass('hide');
                        $('#ladepunktConfigModal').find('[data-config-lp="'+currentConfigureLp+'"]').removeClass('hide');
                        $('#ladepunktConfigModal').modal("show");
                    } else {
                        $("#lockInfoModal").modal("show");
                    }
                });

                $('.chargeModeSelectBtn').click(function(event){
                    if( displaylocked == false ){
                        $("#chargeModeModal").modal("show");
                    } else {
                        $("#lockInfoModal").modal("show");
                    }
                });

                $('#lastmanagementShowBtn').click(function(event){
                    $("#lastregelungModal").modal("show");
                });

                $('.enableLp').click(function(event){
                    if( displaylocked == false ){
                        // send mqtt set to enable/disable charge point after click
                        var lp = parseInt($(this).closest('[data-lp]').data('lp'));  // get attribute lp-# of parent element
                        if ( !isNaN(parseInt(lp)) && lp > 0 && lp < 9 ) {
                            var isDisabled = $(this).hasClass("lpDisabledStyle")
                            if ( isDisabled ) {
                                publish("1", "openWB/set/lp/" + lp + "/ChargePointEnabled");
                            } else {
                                publish("0", "openWB/set/lp/" + lp + "/ChargePointEnabled");
                            }
                        }
                    } else {
                        $("#lockInfoModal").modal("show");
                    }
                });
            </script>
        </div>

        <!-- Code -->
        <div id="code" class="code resume">
            <form action="" method="" name="PINform" id="PINform" autocomplete="off">
                <div id="PINcode" class="text-center">
                    <input id="PINbox" type="text" value="" name="PINbox" disabled="disabled">
                    <br>
                    <input type="button" class="PINbutton" name="1" value="1" id="1" onclick="addNumber(this);">
                    <input type="button" class="PINbutton" name="2" value="2" id="2" onclick="addNumber(this);">
                    <input type="button" class="PINbutton" name="3" value="3" id="3" onclick="addNumber(this);">
                    <br>
                    <input type="button" class="PINbutton" name="4" value="4" id="4" onclick="addNumber(this);">
                    <input type="button" class="PINbutton" name="5" value="5" id="5" onclick="addNumber(this);">
                    <input type="button" class="PINbutton" name="6" value="6" id="6" onclick="addNumber(this);">
                    <br>
                    <input type="button" class="PINbutton" name="7" value="7" id="7" onclick="addNumber(this);">
                    <input type="button" class="PINbutton" name="8" value="8" id="8" onclick="addNumber(this);">
                    <input type="button" class="PINbutton" name="9" value="9" id="9" onclick="addNumber(this);">
                    <br>
                    <input type="button" class="PINbutton clear" name="-" value="clear" id="-" onclick="clearForm(this);">
                    <input type="button" class="PINbutton" name="0" value="0" id="0" onclick="addNumber(this);">
                    <input type="button" class="PINbutton enter" name="+" value="enter" id="+" onclick="submitForm(PINbox);">
                </div>
            </form>
            <script>
                function addNumber(e){
                    var v = $( "#PINbox" ).val();
                    $( "#PINbox" ).val( v + e.value );
                }

                function clearForm(e){
                    $( "#PINbox" ).val( "" );
                }

                function submitForm(e) {
                    publish( e.value, "openWB/set/system/SimulateRFID" );
                    $( "#PINbox" ).val( "" );
                };
            </script>
        </div>

        <!-- modal chargepoint-config-window -->
        <div class="modal" id="ladepunktConfigModal">
            <div class="modal-dialog">
                <div class="modal-content border-promary">
                    <!-- modal header -->
                    <div class="modal-header bg-primary justify-content-center">
                        <div class="modal-title text-light text-center">Einstellungen Ladepunkt <span class="configLp"></span></div>
                    </div>
                    <!-- modal body -->
                    <div class="modal-body">
                        <div data-config-lp="1" class="hide">
                            <div class="ladepunktConfig ladepunktConfigSofort">
                                <div class="form-row vaRow">
                                    <div class="col-4">
                                        <label for="lp/1/current" class="col-form-label">Stromstärke: </label>
                                        <label for="lp/1/current" class="col-form-label valueLabel" suffix="A"></label>
                                    </div>
                                    <div class="col">
                                        <input type="range" class="form-control-range rangeInput" id="lp/1/current" min="6" max="32" step="1" value="6" data-initialized="0" data-topicprefix="openWB/config/get/sofort/">
                                    </div>
                                </div>
                                <div class="chargeLimitation" data-lp="1">
                                    <div class="form-row vaRow">
                                        <div class="col-4">
                                            <label for="lp/1/chargeLimitation" class="col-form-label">Begrenzung</label>
                                        </div>
                                        <div class="col btn-group btn-group-toggle" id="lp/1/chargeLimitation" data-toggle="buttons" data-topicprefix="openWB/config/get/sofort/">
                                            <label class="btn btn-lg btn-outline-info btn-toggle regularTextSize">
                                                <input type="radio" name="lp/1/chargeLimitation" data-option="0"> keine
                                            </label>
                                            <label class="btn btn-lg btn-outline-info btn-toggle regularTextSize">
                                                <input type="radio" name="lp/1/chargeLimitation" data-option="2"> EV-SoC
                                            </label>
                                            <label class="btn btn-lg btn-outline-info btn-toggle regularTextSize">
                                                <input type="radio" name="lp/1/chargeLimitation" data-option="1"> Energiemenge
                                            </label>
                                        </div>
                                    </div>
                                    <div class="form-row vaRow form-group" data-option="1">
                                        <div class="col-4">
                                            <label for="lp/1/energyToCharge" class="col-form-label">Energie:</label>
                                            <label for="lp/1/energyToCharge" class="col-form-label valueLabel" suffix="kWh"></label>
                                        </div>
                                        <div class="col">
                                            <input type="range" class="form-control-range rangeInput" id="lp/1/energyToCharge" min="2" max="100" step="2" value="2" data-topicprefix="openWB/config/get/sofort/">
                                        </div>
                                    </div>
                                    <div class="form-row vaRow form-group" data-option="2">
                                        <div class="col-4">
                                            <label for="lp/1/socToChargeTo" class="col-form-label">SoC:</label>
                                            <label for="lp/1/socToChargeTo" class="col-form-label valueLabel" suffix="%"></label>
                                        </div>
                                        <div class="col">
                                            <input type="range" class="form-control-range rangeInput" id="lp/1/socToChargeTo" min="5" max="100" step="5" value="5" data-topicprefix="openWB/config/get/sofort/">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="ladepunktConfig ladepunktConfigPv">
                                <div class="form-row vaRow">
                                    <div class="col text-center text-info">In dem Lademodus "PV" gibt es keine Einstellungen.</div>
                                </div>
                            </div>
                            <div class="ladepunktConfig ladepunktConfigMinPv">
                                <div class="form-row vaRow">
                                    <div class="col-4">
                                        <label for="minCurrentMinPv" class="col-form-label">Min.-Strom: </label>
                                        <label for="minCurrentMinPv" class="col-form-label valueLabel" suffix="A"></label>
                                    </div>
                                    <div class="col">
                                        <input type="range" class="form-control-range rangeInput" id="minCurrentMinPv" min="6" max="16" step="1" value="6" data-initialized="0" data-topicprefix="openWB/config/get/pv/">
                                    </div>
                                </div>
                                <div class="form-row vaRow">
                                    <div class="col text-center text-info">Diese Einstellung gilt für alle Ladepunkte!</div>
                                </div>
                            </div>
                            <div class="ladepunktConfig ladepunktConfigStandby">
                                <div class="form-row vaRow">
                                    <div class="col text-center text-info">In dem Lademodus "Standby" gibt es keine Einstellungen.</div>
                                </div>
                            </div>
                            <div class="ladepunktConfig ladepunktConfigStop">
                                <div class="form-row vaRow">
                                    <div class="col text-center text-info">In dem Lademodus "Stop" gibt es keine Einstellungen.</div>
                                </div>
                            </div>
                        </div>
                        <div data-config-lp="2" class="hide">
                            <div class="ladepunktConfig ladepunktConfigSofort">
                                <div class="form-row vaRow">
                                    <div class="col-4">
                                        <label for="lp/2/current" class="col-form-label">Stromstärke: </label>
                                        <label for="lp/2/current" class="col-form-label valueLabel" suffix="A"></label>
                                    </div>
                                    <div class="col">
                                        <input type="range" class="form-control-range rangeInput" id="lp/2/current" min="6" max="32" step="1" value="6" data-initialized="0" data-topicprefix="openWB/config/get/sofort/">
                                    </div>
                                </div>
                                <div class="chargeLimitation" data-lp="2">
                                    <div class="form-row vaRow">
                                        <div class="col-4">
                                            <label for="lp/2/chargeLimitation" class="col-form-label">Begrenzung</label>
                                        </div>
                                        <div class="col btn-group btn-group-toggle" id="lp/2/chargeLimitation" data-toggle="buttons" data-topicprefix="openWB/config/get/sofort/">
                                            <label class="btn btn-lg btn-outline-info btn-toggle regularTextSize">
                                                <input type="radio" name="lp/2/chargeLimitation" data-option="0"> keine
                                            </label>
                                            <label class="btn btn-lg btn-outline-info btn-toggle regularTextSize">
                                                <input type="radio" name="lp/2/chargeLimitation" data-option="2"> EV-SoC
                                            </label>
                                            <label class="btn btn-lg btn-outline-info btn-toggle regularTextSize">
                                                <input type="radio" name="lp/2/chargeLimitation" data-option="1"> Energiemenge
                                            </label>
                                        </div>
                                    </div>
                                    <div class="form-row vaRow form-group" data-option="1">
                                        <div class="col-4">
                                            <label for="lp/2/energyToCharge" class="col-form-label">Energie:</label>
                                            <label for="lp/2/energyToCharge" class="col-form-label valueLabel" suffix="kWh"></label>
                                        </div>
                                        <div class="col">
                                            <input type="range" class="form-control-range rangeInput" id="lp/2/energyToCharge" min="2" max="100" step="2" value="2" data-topicprefix="openWB/config/get/sofort/">
                                        </div>
                                    </div>
                                    <div class="form-row vaRow form-group" data-option="2">
                                        <div class="col-4">
                                            <label for="lp/2/socToChargeTo" class="col-form-label">SoC:</label>
                                            <label for="lp/2/socToChargeTo" class="col-form-label valueLabel" suffix="%"></label>
                                        </div>
                                        <div class="col">
                                            <input type="range" class="form-control-range rangeInput" id="lp/2/socToChargeTo" min="5" max="100" step="5" value="5" data-topicprefix="openWB/config/get/sofort/">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="ladepunktConfig ladepunktConfigPv">
                                <div class="form-row vaRow">
                                    <div class="col text-center text-info">In dem Lademodus "PV" gibt es keine Einstellungen.</div>
                                </div>
                            </div>
                            <div class="ladepunktConfig ladepunktConfigStandby">
                                <div class="form-row vaRow">
                                    <div class="col text-center text-info">In dem Lademodus "Standby" gibt es keine Einstellungen.</div>
                                </div>
                            </div>
                            <div class="ladepunktConfig ladepunktConfigStop">
                                <div class="form-row vaRow">
                                    <div class="col text-center text-info">In dem Lademodus "Stop" gibt es keine Einstellungen.</div>
                                </div>
                            </div>
                        </div>
                        <div data-config-lp="3" class="hide">
                            <div class="ladepunktConfig ladepunktConfigSofort">
                                <div class="form-row vaRow">
                                    <div class="col-4">
                                        <label for="lp/3/current" class="col-form-label">Stromstärke: </label>
                                        <label for="lp/3/current" class="col-form-label valueLabel" suffix="A"></label>
                                    </div>
                                    <div class="col">
                                        <input type="range" class="form-control-range rangeInput" id="lp/3/current" min="6" max="32" step="1" value="6" data-initialized="0" data-topicprefix="openWB/config/get/sofort/">
                                    </div>
                                </div>
                                <div class="chargeLimitation" data-lp="3">
                                    <div class="form-row vaRow">
                                        <div class="col-4">
                                            <label for="lp/3/chargeLimitation" class="col-form-label">Begrenzung</label>
                                        </div>
                                        <div class="col btn-group btn-group-toggle" id="lp/3/chargeLimitation" data-toggle="buttons" data-topicprefix="openWB/config/get/sofort/">
                                            <label class="btn btn-lg btn-outline-info btn-toggle regularTextSize">
                                                <input type="radio" name="lp/3/chargeLimitation" data-option="0"> keine
                                            </label>
                                            <label class="btn btn-lg btn-outline-info btn-toggle regularTextSize">
                                                <input type="radio" name="lp/3/chargeLimitation" data-option="1"> Energiemenge
                                            </label>
                                        </div>
                                    </div>
                                    <div class="form-row vaRow form-group" data-option="1">
                                        <div class="col-4">
                                            <label for="lp/3/energyToCharge" class="col-form-label">Energie:</label>
                                            <label for="lp/3/energyToCharge" class="col-form-label valueLabel" suffix="kWh"></label>
                                        </div>
                                        <div class="col">
                                            <input type="range" class="form-control-range rangeInput" id="lp/3/energyToCharge" min="2" max="100" step="2" value="2" data-topicprefix="openWB/config/get/sofort/">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="ladepunktConfig ladepunktConfigPv">
                                <div class="form-row vaRow">
                                    <div class="col text-center text-info">In dem Lademodus "PV" gibt es keine Einstellungen.</div>
                                </div>
                            </div>
                            <div class="ladepunktConfig ladepunktConfigStandby">
                                <div class="form-row vaRow">
                                    <div class="col text-center text-info">In dem Lademodus "Standby" gibt es keine Einstellungen.</div>
                                </div>
                            </div>
                            <div class="ladepunktConfig ladepunktConfigStop">
                                <div class="form-row vaRow">
                                    <div class="col text-center text-info">In dem Lademodus "Stop" gibt es keine Einstellungen.</div>
                                </div>
                            </div>
                        </div>
                        <div data-config-lp="4" class="hide">
                            <div class="ladepunktConfig ladepunktConfigSofort">
                                <div class="form-row vaRow">
                                    <div class="col-4">
                                        <label for="lp/4/current" class="col-form-label">Stromstärke: </label>
                                        <label for="lp/4/current" class="col-form-label valueLabel" suffix="A"></label>
                                    </div>
                                    <div class="col">
                                        <input type="range" class="form-control-range rangeInput" id="lp/4/current" min="6" max="32" step="1" value="6" data-initialized="0" data-topicprefix="openWB/config/get/sofort/">
                                    </div>
                                </div>
                                <div class="chargeLimitation" data-lp="4">
                                    <div class="form-row vaRow">
                                        <div class="col-4">
                                            <label for="lp/4/chargeLimitation" class="col-form-label">Begrenzung</label>
                                        </div>
                                        <div class="col btn-group btn-group-toggle" id="lp/4/chargeLimitation" data-toggle="buttons" data-topicprefix="openWB/config/get/sofort/">
                                            <label class="btn btn-lg btn-outline-info btn-toggle regularTextSize">
                                                <input type="radio" name="lp/4/chargeLimitation" data-option="0"> keine
                                            </label>
                                            <label class="btn btn-lg btn-outline-info btn-toggle regularTextSize">
                                                <input type="radio" name="lp/4/chargeLimitation" data-option="1"> Energiemenge
                                            </label>
                                        </div>
                                    </div>
                                    <div class="form-row vaRow form-group" data-option="1">
                                        <div class="col-4">
                                            <label for="lp/4/energyToCharge" class="col-form-label">Energie:</label>
                                            <label for="lp/4/energyToCharge" class="col-form-label valueLabel" suffix="kWh"></label>
                                        </div>
                                        <div class="col">
                                            <input type="range" class="form-control-range rangeInput" id="lp/4/energyToCharge" min="2" max="100" step="2" value="2" data-topicprefix="openWB/config/get/sofort/">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="ladepunktConfig ladepunktConfigPv">
                                <div class="form-row vaRow">
                                    <div class="col text-center text-info">In dem Lademodus "PV" gibt es keine Einstellungen.</div>
                                </div>
                            </div>
                            <div class="ladepunktConfig ladepunktConfigStandby">
                                <div class="form-row vaRow">
                                    <div class="col text-center text-info">In dem Lademodus "Standby" gibt es keine Einstellungen.</div>
                                </div>
                            </div>
                            <div class="ladepunktConfig ladepunktConfigStop">
                                <div class="form-row vaRow">
                                    <div class="col text-center text-info">In dem Lademodus "Stop" gibt es keine Einstellungen.</div>
                                </div>
                            </div>
                        </div>
                        <div data-config-lp="5" class="hide">
                            <div class="ladepunktConfig ladepunktConfigSofort">
                                <div class="form-row vaRow">
                                    <div class="col-4">
                                        <label for="lp/5/current" class="col-form-label">Stromstärke: </label>
                                        <label for="lp/5/current" class="col-form-label valueLabel" suffix="A"></label>
                                    </div>
                                    <div class="col">
                                        <input type="range" class="form-control-range rangeInput" id="lp/5/current" min="6" max="32" step="1" value="6" data-initialized="0" data-topicprefix="openWB/config/get/sofort/">
                                    </div>
                                </div>
                                <div class="chargeLimitation" data-lp="5">
                                    <div class="form-row vaRow">
                                        <div class="col-4">
                                            <label for="lp/5/chargeLimitation" class="col-form-label">Begrenzung</label>
                                        </div>
                                        <div class="col btn-group btn-group-toggle" id="lp/5/chargeLimitation" data-toggle="buttons" data-topicprefix="openWB/config/get/sofort/">
                                            <label class="btn btn-lg btn-outline-info btn-toggle regularTextSize">
                                                <input type="radio" name="lp/5/chargeLimitation" data-option="0"> keine
                                            </label>
                                            <label class="btn btn-lg btn-outline-info btn-toggle regularTextSize">
                                                <input type="radio" name="lp/5/chargeLimitation" data-option="1"> Energiemenge
                                            </label>
                                        </div>
                                    </div>
                                    <div class="form-row vaRow form-group" data-option="1">
                                        <div class="col-4">
                                            <label for="lp/5/energyToCharge" class="col-form-label">Energie:</label>
                                            <label for="lp/5/energyToCharge" class="col-form-label valueLabel" suffix="kWh"></label>
                                        </div>
                                        <div class="col">
                                            <input type="range" class="form-control-range rangeInput" id="lp/5/energyToCharge" min="2" max="100" step="2" value="2" data-topicprefix="openWB/config/get/sofort/">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="ladepunktConfig ladepunktConfigPv">
                                <div class="form-row vaRow">
                                    <div class="col text-center text-info">In dem Lademodus "PV" gibt es keine Einstellungen.</div>
                                </div>
                            </div>
                            <div class="ladepunktConfig ladepunktConfigStandby">
                                <div class="form-row vaRow">
                                    <div class="col text-center text-info">In dem Lademodus "Standby" gibt es keine Einstellungen.</div>
                                </div>
                            </div>
                            <div class="ladepunktConfig ladepunktConfigStop">
                                <div class="form-row vaRow">
                                    <div class="col text-center text-info">In dem Lademodus "Stop" gibt es keine Einstellungen.</div>
                                </div>
                            </div>
                        </div>
                        <div data-config-lp="6" class="hide">
                            <div class="ladepunktConfig ladepunktConfigSofort">
                                <div class="form-row vaRow">
                                    <div class="col-4">
                                        <label for="lp/6/current" class="col-form-label">Stromstärke: </label>
                                        <label for="lp/6/current" class="col-form-label valueLabel" suffix="A"></label>
                                    </div>
                                    <div class="col">
                                        <input type="range" class="form-control-range rangeInput" id="lp/6/current" min="6" max="32" step="1" value="6" data-initialized="0" data-topicprefix="openWB/config/get/sofort/">
                                    </div>
                                </div>
                                <div class="chargeLimitation" data-lp="6">
                                    <div class="form-row vaRow">
                                        <div class="col-4">
                                            <label for="lp/6/chargeLimitation" class="col-form-label">Begrenzung</label>
                                        </div>
                                        <div class="col btn-group btn-group-toggle" id="lp/6/chargeLimitation" data-toggle="buttons" data-topicprefix="openWB/config/get/sofort/">
                                            <label class="btn btn-lg btn-outline-info btn-toggle regularTextSize">
                                                <input type="radio" name="lp/6/chargeLimitation" data-option="0"> keine
                                            </label>
                                            <label class="btn btn-lg btn-outline-info btn-toggle regularTextSize">
                                                <input type="radio" name="lp/6/chargeLimitation" data-option="1"> Energiemenge
                                            </label>
                                        </div>
                                    </div>
                                    <div class="form-row vaRow form-group" data-option="1">
                                        <div class="col-4">
                                            <label for="lp/6/energyToCharge" class="col-form-label">Energie:</label>
                                            <label for="lp/6/energyToCharge" class="col-form-label valueLabel" suffix="kWh"></label>
                                        </div>
                                        <div class="col">
                                            <input type="range" class="form-control-range rangeInput" id="lp/6/energyToCharge" min="2" max="100" step="2" value="2" data-topicprefix="openWB/config/get/sofort/">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="ladepunktConfig ladepunktConfigPv">
                                <div class="form-row vaRow">
                                    <div class="col text-center text-info">In dem Lademodus "PV" gibt es keine Einstellungen.</div>
                                </div>
                            </div>
                            <div class="ladepunktConfig ladepunktConfigStandby">
                                <div class="form-row vaRow">
                                    <div class="col text-center text-info">In dem Lademodus "Standby" gibt es keine Einstellungen.</div>
                                </div>
                            </div>
                            <div class="ladepunktConfig ladepunktConfigStop">
                                <div class="form-row vaRow">
                                    <div class="col text-center text-info">In dem Lademodus "Stop" gibt es keine Einstellungen.</div>
                                </div>
                            </div>
                        </div>
                        <div data-config-lp="7" class="hide">
                            <div class="ladepunktConfig ladepunktConfigSofort">
                                <div class="form-row vaRow">
                                    <div class="col-4">
                                        <label for="lp/7/current" class="col-form-label">Stromstärke: </label>
                                        <label for="lp/7/current" class="col-form-label valueLabel" suffix="A"></label>
                                    </div>
                                    <div class="col">
                                        <input type="range" class="form-control-range rangeInput" id="lp/7/current" min="6" max="32" step="1" value="6" data-initialized="0" data-topicprefix="openWB/config/get/sofort/">
                                    </div>
                                </div>
                                <div class="chargeLimitation" data-lp="7">
                                    <div class="form-row vaRow">
                                        <div class="col-4">
                                            <label for="lp/7/chargeLimitation" class="col-form-label">Begrenzung</label>
                                        </div>
                                        <div class="col btn-group btn-group-toggle" id="lp/7/chargeLimitation" data-toggle="buttons" data-topicprefix="openWB/config/get/sofort/">
                                            <label class="btn btn-lg btn-outline-info btn-toggle regularTextSize">
                                                <input type="radio" name="lp/7/chargeLimitation" data-option="0"> keine
                                            </label>
                                            <label class="btn btn-lg btn-outline-info btn-toggle regularTextSize">
                                                <input type="radio" name="lp/7/chargeLimitation" data-option="1"> Energiemenge
                                            </label>
                                        </div>
                                    </div>
                                    <div class="form-row vaRow form-group" data-option="1">
                                        <div class="col-4">
                                            <label for="lp/7/energyToCharge" class="col-form-label">Energie:</label>
                                            <label for="lp/7/energyToCharge" class="col-form-label valueLabel" suffix="kWh"></label>
                                        </div>
                                        <div class="col">
                                            <input type="range" class="form-control-range rangeInput" id="lp/7/energyToCharge" min="2" max="100" step="2" value="2" data-topicprefix="openWB/config/get/sofort/">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="ladepunktConfig ladepunktConfigPv">
                                <div class="form-row vaRow">
                                    <div class="col text-center text-info">In dem Lademodus "PV" gibt es keine Einstellungen.</div>
                                </div>
                            </div>
                            <div class="ladepunktConfig ladepunktConfigStandby">
                                <div class="form-row vaRow">
                                    <div class="col text-center text-info">In dem Lademodus "Standby" gibt es keine Einstellungen.</div>
                                </div>
                            </div>
                            <div class="ladepunktConfig ladepunktConfigStop">
                                <div class="form-row vaRow">
                                    <div class="col text-center text-info">In dem Lademodus "Stop" gibt es keine Einstellungen.</div>
                                </div>
                            </div>
                        </div>
                        <div data-config-lp="8" class="hide">
                            <div class="ladepunktConfig ladepunktConfigSofort">
                                <div class="form-row vaRow">
                                    <div class="col-4">
                                        <label for="lp/8/current" class="col-form-label">Stromstärke: </label>
                                        <label for="lp/8/current" class="col-form-label valueLabel" suffix="A"></label>
                                    </div>
                                    <div class="col">
                                        <input type="range" class="form-control-range rangeInput" id="lp/8/current" min="6" max="32" step="1" value="6" data-initialized="0" data-topicprefix="openWB/config/get/sofort/">
                                    </div>
                                </div>
                                <div class="chargeLimitation" data-lp="8">
                                    <div class="form-row vaRow">
                                        <div class="col-4">
                                            <label for="lp/8/chargeLimitation" class="col-form-label">Begrenzung</label>
                                        </div>
                                        <div class="col btn-group btn-group-toggle" id="lp/8/chargeLimitation" data-toggle="buttons" data-topicprefix="openWB/config/get/sofort/">
                                            <label class="btn btn-lg btn-outline-info btn-toggle regularTextSize">
                                                <input type="radio" name="lp/8/chargeLimitation" data-option="0"> keine
                                            </label>
                                            <label class="btn btn-lg btn-outline-info btn-toggle regularTextSize">
                                                <input type="radio" name="lp/8/chargeLimitation" data-option="1"> Energiemenge
                                            </label>
                                        </div>
                                    </div>
                                    <div class="form-row vaRow form-group" data-option="1">
                                        <div class="col-4">
                                            <label for="lp/8/energyToCharge" class="col-form-label">Energie:</label>
                                            <label for="lp/8/energyToCharge" class="col-form-label valueLabel" suffix="kWh"></label>
                                        </div>
                                        <div class="col">
                                            <input type="range" class="form-control-range rangeInput" id="lp/8/energyToCharge" min="2" max="100" step="2" value="2" data-topicprefix="openWB/config/get/sofort/">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="ladepunktConfig ladepunktConfigPv">
                                <div class="form-row vaRow">
                                    <div class="col text-center text-info">In dem Lademodus "PV" gibt es keine Einstellungen.</div>
                                </div>
                            </div>
                            <div class="ladepunktConfig ladepunktConfigStandby">
                                <div class="form-row vaRow">
                                    <div class="col text-center text-info">In dem Lademodus "Standby" gibt es keine Einstellungen.</div>
                                </div>
                            </div>
                            <div class="ladepunktConfig ladepunktConfigStop">
                                <div class="form-row vaRow">
                                    <div class="col text-center text-info">In dem Lademodus "Stop" gibt es keine Einstellungen.</div>
                                </div>
                            </div>
                        </div>
                    </div> <!-- /modal body -->
                    <!-- no modal footer -->
                </div>
            </div>
        </div>

        <!-- modal lock-window -->
        <div class="modal" id="lockModal">
            <div class="modal-dialog">
                <div class="modal-content">
                    <!-- modal header -->
                    <div class="modal-header bg-warning justify-content-center">
                        <div class="modal-title text-dark text-center">Eingaben entsperren</div>
                    </div>
                    <!-- modal body -->
                    <div class="modal-body">
                        <form action="" method="" name="Lockform" id="Lockform" autocomplete="off">
                            <div id="Lockcode" class="text-center">
                                <input id="Lockbox" type="password" value="" name="Lockbox" disabled="disabled" class="text-center display-4" size="4">
                                <br>
                                <input type="button" class="PINbutton" name="1" value="1" onclick="addLockNumber(this);">
                                <input type="button" class="PINbutton" name="2" value="2" onclick="addLockNumber(this);">
                                <input type="button" class="PINbutton" name="3" value="3" onclick="addLockNumber(this);">
                                <br>
                                <input type="button" class="PINbutton" name="4" value="4" onclick="addLockNumber(this);">
                                <input type="button" class="PINbutton" name="5" value="5" onclick="addLockNumber(this);">
                                <input type="button" class="PINbutton" name="6" value="6" onclick="addLockNumber(this);">
                                <br>
                                <input type="button" class="PINbutton" name="7" value="7" onclick="addLockNumber(this);">
                                <input type="button" class="PINbutton" name="8" value="8" onclick="addLockNumber(this);">
                                <input type="button" class="PINbutton" name="9" value="9" onclick="addLockNumber(this);">
                                <br>
                                <input type="button" class="PINbutton clear" name="-" value="clear" onclick="clearLockForm(this);" data-dismiss="modal">
                                <input type="button" class="PINbutton" name="0" value="0" onclick="addLockNumber(this);">
                                <input type="button" class="PINbutton enter" name="+" value="enter" onclick="submitLockForm(PINbox);">
                            </div>
                        </form>
                    </div> <!-- /modal body -->
                    <!-- no modal footer -->
                </div>
            </div>
            <script>
                function addLockNumber(e){
                    var v = $( "#Lockbox" ).val();
                    $( "#Lockbox" ).val( v + e.value );
                }

                function clearLockForm(e){
                    $( "#Lockbox" ).val( "" );
                }

                function submitLockForm(e) {
                    $.get(
                        { url: "display/cards/checklock.php?pin="+$('#Lockbox').val(), cache: false },
                        function(data){
                            if( data == 1 ){
                                lockDisplay(false);
                                $('#lockModal').find('.modal-body').addClass('bg-success');
                                $('#Lockcode').find('.enter').prop('disabled', true);
                                window.setTimeout(function(){
                                    $('#lockModal').find('.modal-body').removeClass('bg-success');
                                    $('#Lockcode').find('.enter').prop('disabled', false);
                                    $( "#Lockbox" ).val( "" );
                                    $("#lockModal").modal("hide");
                                }, 1000);
                            } else {
                                $('#lockModal').find('.modal-body').addClass('bg-danger');
                                $('#Lockcode').find('.enter').prop('disabled', true);
                                window.setTimeout(function(){
                                    $('#lockModal').find('.modal-body').removeClass('bg-danger');
                                    $('#Lockcode').find('.enter').prop('disabled', false);
                                    $( "#Lockbox" ).val( "" );
                                }, 3000);
                            }
                        }
                    );
                };
            </script>
        </div>

        <!-- modal alert-window -->
        <div class="modal" id="lastregelungModal">
            <div class="modal-dialog">
                <div class="modal-content">
                    <!-- modal header -->
                    <div class="modal-header bg-danger justify-content-center">
                        <div class="modal-title text-light text-center">Warnmeldungen</div>
                    </div>
                    <!-- modal body -->
                    <div class="modal-body">
                        <h4 class="text-danger" id="lastregelungaktiv"></h4>
                    </div> <!-- /modal body -->
                    <!-- no modal footer -->
                </div>
            </div>
        </div>

        <!-- modal wizzard-window -->
        <div class="modal" id="wizzardModal">
            <div class="modal-dialog">
                <div class="modal-content">
                    <!-- modal header -->
                    <div class="modal-header bg-warning justify-content-center">
                        <div class="modal-title text-center">Einrichtungs-Assistent</div>
                    </div>
                    <!-- modal body -->
                    <div class="modal-body">
                        <h4 class="text-light text-center">
                            Bitte rufen Sie in einem Browser die Weboberfläche dieser openWB auf.
                            Sie werden mit einem Assistenten durch die Einrichtung der Module geführt.
                        </h4>
                        <h4 class="text-warning text-center">
                            Die IP lautet: <span id="systemIpAddress">&nbsp;</span>
                        </h4>
                    </div> <!-- /modal body -->
                    <!-- no modal footer -->
                </div>
            </div>
        </div>

        <!-- modal chargemode-select-window -->
        <div class="modal" id="chargeModeModal">
            <div class="modal-dialog">
                <div class="modal-content">
                    <!-- modal header -->
                    <div class="modal-header bg-success justify-content-center">
                        <div class="modal-title text-light text-center">Lademodus-Auswahl</div>
                    </div>
                    <!-- modal body -->
                    <div class="modal-body">
                        <div class="row justify-content-center">
                            <div class="col-sm-4 px-3 pb-3 pt-1">
                                <button id="chargeModeSofortBtn" type="button" class="chargeModeBtn btn btn-lg btn-block btn-secondary" data-dismiss="modal" chargeMode="0">Sofort</button>
                            </div>
                            <div class="col-sm-4 px-3 pb-3 pt-1">
                                <button id="chargeModePVBtn" type="button" class="chargeModeBtn btn btn-lg btn-block btn-secondary" data-dismiss="modal" chargeMode="2">PV</button>
                            </div>
                            <div class="col-sm-4 px-3 pb-3 pt-1">
                                <button id="chargeModeMinPVBtn" type="button" class="chargeModeBtn btn btn-lg btn-block btn-secondary" data-dismiss="modal" chargeMode="1">Min + PV</button>
                            </div>
                            <div class="col-sm-4 px-3 pb-3 pt-1">
                                <button id="chargeModeStdbyBtn" type="button" class="chargeModeBtn btn btn-lg btn-block btn-secondary" data-dismiss="modal" chargeMode="4">Standby</button>
                            </div>
                            <div class="col-sm-4 px-3 pb-3 pt-1">
                                <button id="chargeModeStopBtn" type="button" class="chargeModeBtn btn btn-lg btn-block btn-secondary" data-dismiss="modal" chargeMode="3">Stop</button>
                            </div>
                        </div>
                        <span id='priorityModeBtns'>
                            <hr>
                            <div class="row">
                                <h3 class="col text-center text-light">Vorrang im Lademodus PV-Laden:</h3>
                            </div>
                            <div class="row justify-content-center">
                                <div class="col-sm-5 py-1">
                                    <button id="evPriorityBtn" type="button" class="priorityModeBtn btn btn-lg btn-block btn-secondary" data-dismiss="modal" priority="1">
                                        EV <span class="fas fa-car">&nbsp;</span>
                                    </button>
                                </div>
                                <div class="col-sm-5 py-1">
                                    <button id="batteryPriorityBtn" type="button" class="priorityModeBtn btn btn-lg btn-block btn-secondary" data-dismiss="modal" priority="0">
                                        Speicher <span class="fas fa-car-battery">&nbsp;</span>
                                    </button>
                                </div>
                            </div>
                        </span>
                        <span id='70ModeBtn'>
                            <hr>
                            <div class="row">
                                <h3 class="col text-center text-light">70% beachten im Lademodus PV-Laden:</h3>
                            </div>
                            <div class="row justify-content-center">
                                <div class="col-sm-8 py-1">
                                    <button id="70PvBtn" type="button" class=" 70PvBtn btn btn-lg btn-block btn-secondary" data-dismiss="modal">
                                        70 % beachten
                                    </button>
                                </div>
                            </div>
                        </span>
                    </div> <!-- /modal body -->
                    <!-- no modal footer -->
                </div>
            </div>
            <script>
                $('.chargeModeBtn').click(function(event){
                    if( displaylocked == false ){
                        var chargeMode = $(this).attr("chargeMode")
                        publish(chargeMode, "openWB/set/ChargeMode");
                    }
                });

                $('.priorityModeBtn').click(function(event){
                    // prio: 0 = battery, 1 = ev
                    if( displaylocked == false ){
                        var priority = $(this).attr('priority');
                        if ( priority == '0' || priority == '1' ) {
                            publish(priority, 'openWB/config/set/pv/priorityModeEVBattery');
                        }
                    }
                });

                $('.70PvBtn').click(function(event){
                    // 0 deaktiviert, 1 aktiviert
                    if( displaylocked == false ){
                        var element = document.getElementById('70PvBtn');
                        if ( element.classList.contains("btn-success") ) {
                            publish("0", "openWB/set/pv/NurPV70Status");
                        } else {
                            publish("1", "openWB/set/pv/NurPV70Status");
                        }
                    }
                });
            </script>
        </div>

        <!-- modal lock-info-window -->
        <div class="modal" id="lockInfoModal">
            <div class="modal-dialog">
                <div class="modal-content">
                    <!-- modal header -->
                    <div class="modal-header bg-warning justify-content-center">
                        <div class="modal-title text-center">Display gesperrt</div>
                    </div>
                    <!-- modal body -->
                    <div class="modal-body">
                        <h4 class="text-light text-center">
                            Das Display ist mit einem PIN-Code gesperrt.<br>
                            Bitte tippen Sie links oben auf das <i class="fas fa-lock text-success"></i> und geben den richtigen PIN ein.
                        </h4>
                    </div>
                    <!-- modal footer -->
                    <div class="modal-footer justify-content-center">
                        <div class="row">
                            <div class="col text-center">
                                <button type="button" class="btn btn-lg btn-secondary" data-dismiss="modal">
                                    OK
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <script>
            var displaypinaktiv = 1;
            var lockTimeoutHandler = null;
            var lockTimeout = 60000;
            var displaylocked = true;

            function lockDisplay( lock = true ){
                if( lock == false ){
                    displaylocked = false;
                    $('#displaylock').find('.fa-lock').addClass('hide');
                    $('#displaylock').find('.fa-unlock').removeClass('hide');
                    lockTimeoutHandler = window.setTimeout(lockDisplay, lockTimeout);
                } else {
                    displaylocked = true;
                    $('#displaylock').find('.fa-lock').removeClass('hide');
                    $('#displaylock').find('.fa-unlock').addClass('hide');
                    window.clearTimeout(lockTimeoutHandler);
                    lockTimeoutHandler = null;
                }
            }

            window.setInterval(function(){
                $.get(
                    { url: "display/cards/checklock.php?lock=1", cache: false },
                    function(data){
                        if( data == "1" ){
                            displaypinaktiv = 1;
                            if( lockTimeoutHandler == null ) {
                                displaylocked = true;
                            }
                            $('#displaylock').removeClass('hide');
                        } else {
                            displaypinaktiv = 0;
                            displaylocked = false;
                            window.clearTimeout(lockTimeoutHandler);
                            lockTimeoutHandler = null;
                            $('#displaylock').addClass('hide');
                        }
                    }
                );
            }, 15000);

            var delayUserInput = (function () {
                // sets a timeout on call and resets timout if called again for same id before timeout fires
                var timeoutHandles = {};
                return function (id, callback, ms) {
                    if ( timeoutHandles[id] ) {
                        clearTimeout(timeoutHandles[id]);
                    };
                    timeoutHandles[id] = setTimeout(function(){
                        delete timeoutHandles[id];
                        callback(id);
                    }, ms);
                };
            })();

            function chargeLimitationOptionsShowHide(btnGrp, option) {
                // show/hide all option-parameters in form-rows for selected option
                var parent = btnGrp.closest('.chargeLimitation[data-lp]');  // get parent div element for charge limitation options
                $(parent).find('.form-row[data-option*=' + option + ']').show();  // now show option elements for selected option
                $(parent).find('.form-row[data-option]').not('[data-option*=' + option + ']').hide();  // hide all other option elements
            }

            $(document).ready(function(){

                // load scripts synchronously in order specified
                var scriptsToLoad = [
                    // load mqtt library
                    'js/mqttws31.js',
                    // some helper functions
                    'display/cards/helperFunctions.js?ver=20201201',
                    // functions for processing messages
                    'display/cards/processAllMqttMsg.js?ver=20201201',
                    // functions performing mqtt and start mqtt-service
                    'display/cards/setupMqttServices.js?ver=20201201',
                ];

                scriptsToLoad.forEach(function(src) {
                    var script = document.createElement('script');
                    script.src = src;
                    script.async = false;
                    document.body.appendChild(script);
                });

                // display lock
                $.get(
                    { url: "display/cards/checklock.php?lock=1", cache: false },
                    function(data){
                        if( data == "1" ){
                            displaypinaktiv = 1;
                            $('#displaylock').removeClass('hide');
                        } else {
                            displaypinaktiv = 0;
                            displaylocked = false;
                            $('#displaylock').addClass('hide');
                        }
                    }
                );

                $('#displaylock').on('click', function(){
                    if( displaylocked == true ){
                        $("#lockModal").modal("show");
                    } else {
                        lockDisplay(true);
                    }
                });

                // handling of display panels
                $('.resume') .hide();
                var firstNavTarget = $('.sidenav').find('.btn').not('.hide').first().attr('href');
                $(firstNavTarget).toggle();

                $('.sidenav').find('a[href^="#"]').on('click', function(event) {
                    // hide all panels
                    $('.resume').hide();
                    // get target panel
                    var target = $(this).attr('href');
                    // display target panel
                    $('.resume'+target).toggle();
                    // remove active menu element
                    $('.sidenav').find('.active').removeClass('active');
                    // activate clicked menu element
                    $(this).addClass('active');
                    // update sparklines
                    $.sparkline_display_visible();
                });

                $('.btn-group-toggle').change(function(event){
                    // only charge limitation has class btn-group-toggle so far
                    // option: 0 = keine, 1 = Energiemenge, 2 = EV-SoC
                    var elementId = $(this).attr('id');
                    var option = $('input[name="' + elementId + '"]:checked').data('option').toString();
                    var topic = getTopicToSendTo(elementId);
                    publish(option, topic);
                    // show/hide respective option-values and progress
                    chargeLimitationOptionsShowHide(this, option);
                });

                $('.rangeInput').on('input', function() {
                    // show slider value in label of class valueLabel
                    var elementId = $(this).attr('id');
                    updateLabel(elementId);
                    var element = $('#' + $.escapeSelector(elementId));
                    var label = $('label[for="' + elementId + '"].valueLabel');
                    label.addClass('text-danger');
                    delayUserInput(elementId, function (id) {
                        // gets executed on callback, 2000ms after last input-change
                        // changes label color back to normal and sends input-value by mqtt
                        var elem = $('#' + $.escapeSelector(id));
                        var value = elem.val();
                        var topic = getTopicToSendTo(id);
                        publish(value, topic);
                        var label = $('label[for="' + id + '"].valueLabel');
                        label.removeClass('text-danger');
                        // if rangeInput is for chargeLimitation, recalc progress
                        if ( id.includes('/energyToCharge') ) {
                            var parent = elem.closest('.chargeLimitation')  // get parent div element for charge limitation
                            var element = parent.find('.progress-bar');  // now get parents progressbar
                            var actualCharged = element.data('actualCharged');  // get stored value
                            if ( isNaN(parseFloat(actualCharged)) ) {
                                actualCharged = 0;  // minimum value
                            }
                            var progress = (actualCharged / value * 100).toFixed(0);
                            element.width(progress+"%");
                        }
                    }, 2000);
                });

            });
        </script>
    </body>
</html>
